---
import Text from "@/components/fundations/elements/Text.astro";
import type { News } from '@/lib/supabase/schema';
import { useTranslations, getLangFromUrl, getLangPrefix } from '@/i18n/utils';

interface Props {
  news: News;
}

const { news } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const langPrefix = getLangPrefix(lang);

const newsUrl = langPrefix ? `${langPrefix}/news/${news.slug}` : `/news/${news.slug}`;
const publishedDate = news.published_at ? new Date(news.published_at) : new Date(news.created_at);
const formattedDate = publishedDate.toLocaleDateString(lang === 'en' ? 'en-US' : lang === 'fr' ? 'fr-FR' : lang === 'es' ? 'es-ES' : lang === 'ru' ? 'ru-RU' : 'zh-CN', {
  month: 'short',
  day: 'numeric'
});
---

<a
  href={newsUrl}
  title={news.title}
  class="relative flex items-center gap-x-3 rounded-md bg-base-50 p-4 focus-outline-none"
>
  <div class="min-w-0 flex-1">
    <span class="absolute inset-0" aria-hidden="true"></span>
    <div>
      <Text tag="h3" variant="textSM" class="font-medium text-base-900 line-clamp-2">
        {news.title}
      </Text>
      <Text tag="p" variant="textXS" class="text-base-600 mt-1">
        {formattedDate}
        {news.author_name && ` â€¢ ${news.author_name}`}
      </Text>
    </div>
  </div>
</a>

