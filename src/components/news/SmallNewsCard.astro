---
import Text from "@/components/fundations/elements/Text.astro";
import type { News } from '@/lib/supabase/schema';
import type { NewsArticle } from '@/lib/utils/news-loader';

interface Props {
  news: News | NewsArticle;
}

const { news } = Astro.props;
const lang = 'en';

const newsUrl = '/news/' + news.slug;
const publishedDate = news.published_at ? new Date(news.published_at) : new Date(news.created_at);
// Formater la date manuellement pour éviter toLocaleDateString
const monthNamesShort = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
const month = monthNamesShort[publishedDate.getMonth()];
const day = publishedDate.getDate();
const formattedDate = month + ' ' + day;
---

<a
  href={newsUrl}
  title={news.title}
  class="relative flex items-center gap-x-3 rounded-md bg-base-50 p-4 focus-outline-none"
>
  <div class="min-w-0 flex-1">
    <span class="absolute inset-0" aria-hidden="true"></span>
    <div>
      <Text tag="h3" variant="textSM" class="font-medium text-base-900 dark:text-base-50 line-clamp-2">
        {news.title}
      </Text>
      <Text tag="p" variant="textXS" class="text-base-600 dark:text-base-400 mt-1">
        {formattedDate}
        {news.author_name && ` • ${news.author_name}`}
      </Text>
    </div>
  </div>
</a>

