---
import Text from "@/components/fundations/elements/Text.astro";
import type { Font } from '@/lib/font-finder/types';

interface Props {
  font: Font;
  langPrefix: string;
}

const { font, langPrefix } = Astro.props;
const fontUrl = `/fonts/${font.file}`;
const binUrl = font.bin ? `/fonts/${font.bin}` : null;
const previewUrl = font.preview ? `/previews/${font.preview}` : null;
---

<div class="bg-white rounded-lg border border-base-200 overflow-hidden hover:border-accent-300 hover:shadow-lg transition-all flex flex-col">
  <!-- Preview Image -->
  <div class="aspect-[3/5] w-full bg-base-50 overflow-hidden relative">
    {previewUrl ? (
      <img
        src={previewUrl}
        alt={`${font.name} preview`}
        class="w-full h-full object-cover"
        loading="lazy"
      />
    ) : (
      <div class="w-full h-full flex items-center justify-center text-base-400">
        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 20h16"></path>
          <path d="M6 16l6-6 6 6"></path>
          <path d="M8 12h8"></path>
        </svg>
      </div>
    )}
  </div>
  
  <!-- Font Info -->
  <div class="p-4 flex-1 flex flex-col">
    <div class="mb-3">
      <Text tag="h3" variant="textLG" class="font-semibold text-base-900 mb-1">
        {font.name}
      </Text>
      {font.einkReason && (
        <Text tag="p" variant="textXS" class="text-base-500 line-clamp-2">
          {font.einkReason}
        </Text>
      )}
    </div>
    
    <!-- Font Details -->
    <div class="space-y-1.5 mb-4 text-xs text-base-600">
      {font.x4Preset && (
        <div class="flex items-center gap-2">
          <span class="font-medium">X4 Preset:</span>
          <span>{font.x4Preset.size}pt / {font.x4Preset.lineHeight} line-height</span>
        </div>
      )}
      {font.author && (
        <div class="flex items-center gap-2">
          <span class="font-medium">Author:</span>
          <span>{font.author}</span>
        </div>
      )}
      {font.license && (
        <div class="flex items-center gap-2">
          <span class="font-medium">License:</span>
          <span>{font.license}</span>
        </div>
      )}
      {font.source && (
        <div class="flex items-center gap-2">
          <span class="font-medium">Source:</span>
          <span class="capitalize">{font.source.replace('-', ' ')}</span>
        </div>
      )}
    </div>
    
    <!-- Download Buttons -->
    <div class="mt-auto space-y-2">
      <a
        href={fontUrl}
        download={font.file}
        class="block w-full px-3 py-2 text-sm bg-accent-500 text-white rounded-lg hover:bg-accent-600 transition-colors text-center font-medium"
      >
        Download TTF
      </a>
      {binUrl && (
        <a
          href={binUrl}
          download={font.bin}
          class="block w-full px-3 py-2 text-sm bg-base-900 text-white rounded-lg hover:bg-base-800 transition-colors text-center font-medium"
        >
          Download BIN
        </a>
      )}
    </div>
  </div>
</div>

