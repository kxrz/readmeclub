---
// Export Panel Component
// Download buttons for TTF and BIN formats

import Text from "@/components/fundations/elements/Text.astro";
---

<div class="bg-base-50 rounded-lg border border-base-200 dark:border-base-700 p-4">
  <Text tag="h3" variant="textBase" class="font-semibold text-base-900 dark:text-base-50 mb-4">
    Download
  </Text>

  <div
    x-data="exportPanel()"
    x-init="init()"
    class="space-y-3"
  >
    <!-- TTF Download -->
    <button
      @click="downloadTTF()"
      :disabled="!selectedFont || selectedFont.source === 'upload'"
      class="w-full px-4 py-2 text-sm bg-accent-500 text-base-50 rounded hover:bg-accent-600 disabled:bg-base-200 dark:disabled:bg-base-800 disabled:text-base-400 dark:disabled:text-base-500 dark:text-base-500 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
      Download TTF
    </button>

    <!-- BIN Download -->
    <button
      @click="downloadBIN()"
      :disabled="!selectedFont || !selectedFont.bin || selectedFont.source === 'upload'"
      class="w-full px-4 py-2 text-sm bg-base-900 dark:bg-base-800 text-base-50 rounded hover:bg-base-800 dark:hover:bg-base-700 disabled:bg-base-200 dark:disabled:bg-base-800 dark:disabled:bg-base-800 disabled:text-base-400 dark:disabled:text-base-500 dark:disabled:text-base-500 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="16"
        height="16"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
      Download BIN
    </button>

    <!-- Font Info -->
    <div x-show="selectedFont" class="mt-4 pt-4 border-t border-base-200 dark:border-base-700 text-xs text-base-600 dark:text-base-400 space-y-1">
      <div x-show="selectedFont?.einkReason">
        <span class="font-medium">Why e-ink:</span>
        <span x-text="selectedFont?.einkReason"></span>
      </div>
      <div x-show="selectedFont?.x4Preset">
        <span class="font-medium">X4 Preset:</span>
        <span x-text="`${selectedFont?.x4Preset?.size}px / ${selectedFont?.x4Preset?.lineHeight} line-height`"></span>
      </div>
      <div x-show="selectedFont?.author">
        <span class="font-medium">Author:</span>
        <span x-text="selectedFont?.author"></span>
      </div>
      <div x-show="selectedFont?.license">
        <span class="font-medium">License:</span>
        <span x-text="selectedFont?.license"></span>
      </div>
    </div>
    
    <!-- Info Message -->
    <div class="mt-4 pt-4 border-t border-base-200 dark:border-base-700 text-xs text-base-500 dark:text-base-400">
      <p class="text-sm text-base-600 dark:text-base-400">
        ðŸ’¡ <strong>Note:</strong> These fonts are optimized for e-ink devices and come from{' '}
        <a
          href="https://github.com/nicoverbruggen/ebook-fonts"
          target="_blank"
          rel="noopener noreferrer"
          class="text-accent-600 hover:text-accent-700 underline font-medium"
        >
          ebook-fonts
        </a>
        {' '}by nicoverbruggen, a collection of fonts specifically adapted for EPUB and e-readers.
      </p>
    </div>
  </div>
</div>

<!-- ExportPanel functions are registered in the page head -->

